# 管理界面完整实施计划

## 🎯 总体目标
实现完全符合设计原则的管理界面系统，实现"零手动配置"、"零硬编码"，所有配置操作通过管理界面完成。

---

## 📋 分阶段实施计划

### Phase 1: 管理界面UI框架 (2-3天)
**目标**: 创建管理界面主窗口、快捷键激活、密码验证

**实现内容**:
- [x] 创建 `admin/admin_ui.py` - 管理界面主UI类
- [ ] 实现主窗口布局（使用pygame GUI库或自定义UI组件）
- [ ] 实现快捷键监听（Ctrl+Shift+D）
- [ ] 实现密码验证界面
- [ ] 实现主菜单导航（配置管理、资源管理、系统设置等）
- [ ] 实现基础UI组件（按钮、输入框、下拉列表、树形视图）

**技术决策**:
- 使用 `pygame_gui` 库实现UI组件（需安装: `pip install pygame_gui`）
- 或使用 Tkinter 创建独立窗口（推荐，更成熟的UI库）

**输出**:
- `admin/admin_ui.py` - 主界面类
- `admin/ui_components.py` - 自定义UI组件库
- 管理界面可通过快捷键正常打开和关闭

---

### Phase 2: 配置浏览器 (1-2天)
**目标**: 实现配置文件的树形结构浏览

**实现内容**:
- [ ] 创建树形视图组件
- [ ] 扫描并显示所有配置文件（games/, campaigns/等）
- [ ] 配置分类显示（游戏IP/角色/技能/皮肤/战役/关卡）
- [ ] 配置搜索/筛选功能
- [ ] 配置状态显示（有效/无效/缺少资源）
- [ ] 双击打开配置编辑器

**输出**:
- `admin/config_browser.py` - 配置浏览器类
- 树形结构显示所有配置文件
- 支持搜索和筛选

---

### Phase 3: 游戏IP管理 (2天)
**目标**: 实现游戏IP的完整生命周期管理

**实现内容**:
- [ ] 新增游戏IP界面
  - 输入游戏名称、类型、描述、作者等
  - 自动生成目录结构（characters/, skins/, models/, materials/, assets/）
  - 自动生成 meta.yaml 模板
  - 上传游戏图标
- [ ] 编辑游戏IP界面
  - 加载现有配置
  - 修改游戏元信息
  - 实时保存
- [ ] 删除游戏IP功能
  - 检查是否被战役引用
  - 移动到回收站（含所有子目录）
  - 记录日志
- [ ] 游戏IP列表视图
  - 显示所有游戏IP
  - 状态指示（角色数/皮肤数等）

**输出**:
- `admin/game_manager.py` - 游戏IP管理类
- 完整的游戏IP CRUD功能
- 自动生成目录和配置文件

---

### Phase 4: 角色管理 (2-3天)
**目标**: 实现角色的完整管理功能

**实现内容**:
- [ ] 新增角色界面
  - 选择所属游戏IP
  - 配置基础信息（ID、名称、类型、费用、描述）
  - 配置基础属性（HP、攻击、攻击范围、速度、暴击率等）
  - 添加技能列表（从已有技能中选择或创建新技能）
  - 配置可用皮肤列表
  - 配置AI行为（可选）
  - 上传角色资源（sprite、icon、sounds）
- [ ] 编辑角色界面
  - 加载现有角色配置
  - 所有字段可编辑
  - 实时预览角色属性
- [ ] 删除角色功能
  - 检查是否被战役/关卡引用
  - 移动到回收站
- [ ] 角色列表视图
  - 按游戏IP分组显示
  - 角色卡片展示（含icon、属性预览）
  - 搜索/筛选功能

**输出**:
- `admin/character_manager.py` - 角色管理类
- `admin/character_editor.py` - 角色编辑器UI
- 完整的角色CRUD功能

---

### Phase 5: 技能管理 (2天)
**目标**: 实现技能的完整管理功能

**实现内容**:
- [ ] 新增技能界面
  - 配置技能基础信息
  - 配置技能类型（projectile/aoe/summon/buff/debuff等）
  - 配置伤害参数
  - 配置技能效果（从已有效果中选择）
  - 配置打击反馈（音效/振动/屏幕抖动等）
  - 上传技能资源
- [ ] 编辑技能界面
- [ ] 删除技能功能
- [ ] 技能列表视图

**输出**:
- `admin/skill_manager.py` - 技能管理类
- `admin/skill_editor.py` - 技能编辑器UI

---

### Phase 6: 皮肤管理 (2天)
**目标**: 实现皮肤的完整管理功能

**实现内容**:
- [ ] 新增皮肤界面
  - 选择所属角色
  - 配置皮肤信息
  - 配置解锁条件
  - 配置属性加成
  - 配置特效加成
  - 上传皮肤资源
- [ ] 编辑皮肤界面
- [ ] 删除皮肤功能
- [ ] 皮肤列表视图

**输出**:
- `admin/skin_manager.py` - 皮肤管理类
- `admin/skin_editor.py` - 皮肤编辑器UI

---

### Phase 7: 战役管理 (2天)
**目标**: 实现战役的完整管理功能

**实现内容**:
- [ ] 新增战役界面
  - 配置战役信息
  - 选择防守方/攻击方游戏IP
  - 配置难度等级
  - 上传封面图
- [ ] 编辑战役界面
- [ ] 删除战役功能
- [ ] 战役列表视图

**输出**:
- `admin/campaign_manager.py` - 战役管理类
- `admin/campaign_editor.py` - 战役编辑器UI

---

### Phase 8: 关卡管理 (3-4天)
**目标**: 实现关卡的完整管理功能（最复杂）

**实现内容**:
- [ ] 新增关卡界面
  - 选择所属战役
  - 配置关卡基础信息
  - 配置地图（上传地图资源）
  - 配置基地（血量）
  - **波次可视化编辑器**
    - 添加/删除波次
    - 配置每个波次的敌人
    - 时间轴预览
  - **Boss配置编辑器**
    - 选择Boss角色
    - 配置Boss参数
  - 配置胜利/失败条件
  - 配置奖励
- [ ] 编辑关卡界面
- [ ] 删除关卡功能
- [ ] 关卡列表视图

**重点功能**:
- 波次编辑器需要可视化时间轴
- 支持拖拽调整波次时间
- 实时预览波次难度

**输出**:
- `admin/level_manager.py` - 关卡管理类
- `admin/level_editor.py` - 关卡编辑器UI
- `admin/wave_editor.py` - 波次编辑器组件

---

### Phase 9: UI主题配置管理 (2天)
**目标**: 实现UI主题的可视化配置

**实现内容**:
- [ ] 全局UI主题编辑器
  - 分类显示所有颜色配置（background/text/button/card/game_ui/icon）
  - **颜色选择器组件**
  - 布局参数编辑（padding/button/card尺寸）
  - 实时预览主题效果
- [ ] 关卡UI主题覆盖编辑器
  - 选择要覆盖的颜色类别
  - 继承关系可视化
- [ ] 主题导出/导入功能
- [ ] 主题预设管理（保存常用主题）

**输出**:
- `admin/theme_editor.py` - UI主题编辑器
- `admin/color_picker.py` - 颜色选择器组件
- 支持实时预览主题效果

---

### Phase 10: 关卡配置增强管理 (2天)
**目标**: 实现新增关卡配置项的可视化编辑

**实现内容**:
- [ ] 角色选择配置编辑器
  - 编辑全局配置（settings.yaml）
  - 编辑关卡级配置
  - min_characters / max_characters 调整
- [ ] **战场网格可视化编辑器**
  - 可视化网格预览
  - 拖拽调整网格起始位置
  - 实时显示网格布局
- [ ] 经济系统配置编辑器
  - 初始金币、生成速率、击杀奖励
  - 参数影响预览
- [ ] 战斗系统配置编辑器
  - 冷却时间、攻击间隔、伤害倍数等
  - 参数影响预览

**重点功能**:
- 战场网格编辑器需要实时可视化预览
- 所有参数修改需要即时反馈

**输出**:
- `admin/gameplay_config_editor.py` - 游戏玩法配置编辑器
- `admin/battlefield_editor.py` - 战场可视化编辑器

---

### Phase 11: 资源上传功能 (2-3天)
**目标**: 实现所有类型资源的上传与管理

**实现内容**:
- [ ] 资源管理器主界面
  - 树形结构显示所有资源目录
  - 资源分类（images/audio/models/materials等）
  - 资源预览功能
- [ ] 图片上传功能
  - 文件选择对话框
  - 文件类型验证（PNG/JPG）
  - 文件大小限制检查（可配置）
  - 自动路径分配
  - 重复文件检测
  - 图片预览
- [ ] 音频上传功能
  - 文件类型验证（WAV/OGG/MP3）
  - 音频预览（播放）
- [ ] 模型上传功能（可选，Phase 1简化实现）
  - 文件类型验证（FBX/GLB）
  - 文件大小限制（≤50MB）
- [ ] 批量上传功能
- [ ] 资源使用情况统计
  - 显示哪些配置使用了该资源
  - 未使用资源提示

**输出**:
- `admin/resource_manager.py` - 资源管理器类
- `admin/asset_uploader.py` - 资源上传器
- 支持所有资源类型的上传和管理

---

### Phase 12: 回收站与日志管理 (1天)
**目标**: 完善回收站和日志功能

**实现内容**:
- [ ] 回收站界面
  - 显示所有已删除的配置/资源
  - 按时间/类型分类
  - 预览功能
  - 批量恢复
  - 永久删除（二次确认）
- [ ] 日志查看器
  - 实时显示操作日志
  - 日志筛选（按时间/操作类型/用户）
  - 日志搜索
  - 日志导出（CSV/JSON）
- [ ] 操作统计面板
  - 显示操作统计（新增/修改/删除次数）
  - 最近操作记录

**输出**:
- `admin/recycle_bin_ui.py` - 回收站界面
- `admin/log_viewer.py` - 日志查看器

---

## 📦 技术栈选择

### 方案A: Tkinter (推荐)
**优点**:
- Python标准库，无需额外安装
- 成熟的UI框架，组件丰富
- 文档完善，易于上手
- 可创建独立窗口，不影响游戏主窗口

**缺点**:
- UI样式相对简陋（但功能完全足够）

### 方案B: pygame_gui
**优点**:
- 与pygame集成良好
- UI风格统一

**缺点**:
- 需要额外安装
- 功能相对有限
- 文档不如Tkinter完善

**决策**: 使用 **Tkinter** 实现管理界面

---

## 🗓️ 实施时间表

| 阶段 | 预计时间 | 优先级 |
|------|---------|--------|
| Phase 1: UI框架 | 2-3天 | 🔴 最高 |
| Phase 2: 配置浏览器 | 1-2天 | 🔴 最高 |
| Phase 3: 游戏IP管理 | 2天 | 🔴 最高 |
| Phase 4: 角色管理 | 2-3天 | 🔴 最高 |
| Phase 5: 技能管理 | 2天 | 🟡 高 |
| Phase 6: 皮肤管理 | 2天 | 🟡 高 |
| Phase 7: 战役管理 | 2天 | 🟡 高 |
| Phase 8: 关卡管理 | 3-4天 | 🟡 高 |
| Phase 9: UI主题管理 | 2天 | 🟢 中 |
| Phase 10: 关卡配置增强 | 2天 | 🟢 中 |
| Phase 11: 资源上传 | 2-3天 | 🟢 中 |
| Phase 12: 回收站与日志 | 1天 | 🔵 低 |

**总预计时间**: 约 23-30 天（3-4周）

---

## 🎯 里程碑

### 里程碑1 (1周后)
- ✅ 管理界面基础框架完成
- ✅ 可以通过快捷键打开管理界面
- ✅ 游戏IP管理功能完成
- ✅ 角色管理功能完成

### 里程碑2 (2周后)
- ✅ 技能、皮肤、战役管理完成
- ✅ 关卡管理完成（含波次编辑器）
- ✅ 可以完全通过管理界面创建完整的游戏内容

### 里程碑3 (3周后)
- ✅ UI主题管理完成
- ✅ 关卡配置增强管理完成
- ✅ 资源上传功能完成
- ✅ 回收站与日志完成

### 最终目标
- ✅ 实现"零手动配置"
- ✅ 所有配置操作通过管理界面完成
- ✅ 完全符合设计原则

---

## 📝 开发规范

### 代码规范
1. 所有管理界面相关代码放在 `admin/` 目录
2. 每个功能模块独立文件
3. 使用详细的中文注释
4. 所有操作记录日志
5. 所有删除操作进入回收站

### UI规范
1. 统一的UI风格
2. 清晰的操作提示
3. 错误提示友好
4. 支持撤销操作（重要操作）
5. 二次确认（删除操作）

### 配置文件规范
1. 自动生成的配置文件必须包含完整注释
2. 配置验证在保存前执行
3. 配置模板化生成
4. 支持配置导入/导出

---

## 🚀 立即开始

**下一步行动**:
1. 安装必要依赖（如果需要）
2. 创建 `admin/` 目录结构
3. 开始实施 Phase 1: 管理界面UI框架
4. 创建主窗口和基础UI组件

让我们开始吧！ 🎉
